/*

LICENSE:  MIT
Author:   sine
Email:    sinerwr@gmail.com

*/

syntax = "proto3";

package pb;

message ResponseMsg {
  int32 code = 1;
  string msg = 2;
}

message AAA_RegRequest {
  string random = 1;
  string email = 2;
}

message AAA_APIKeypair {
  string id = 1;
  string key = 2;
}

message AAA_APIToken {
  string id = 1;
  string signature = 2;
}

message AAA_ThirdpartyKey {
  AAA_APIToken apitoken = 1;
  string apitype = 2;
  string name = 3;
  string id = 4;
  string key = 5;
}

service AAA_Open {
  rpc AAA_RegUser(AAA_RegRequest) returns (AAA_APIKeypair){}
}

service AAA_Secret {
  rpc AAA_Auth(AAA_APIToken) returns (ResponseMsg){}
  rpc AAA_ThirdKeypair(AAA_ThirdpartyKey) returns (ResponseMsg){}
  rpc AAA_GetThirdKey(AAA_ThirdpartyKey) returns (AAA_APIKeypair){}
//  rpc AAA_ApplyAuth(AAA_APIKeypair) returns (ResponseMsg){}
//  rpc AAA_AgreeAuth(AAA_APIKeypair) returns (ResponseMsg){}
//  rpc AAA_Policy(AAA_APIKeypair) returns (ResponseMsg){}
}
